<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE Function SYSTEM "../DTD/Function.dtd">
<Function>
	<KnowledgeBase>
        <Title>postHttp</Title>
		<FunctionName>postHttp</FunctionName>
		<FunctionType>Builtin(FileIO)</FunctionType>
		<ArgumentTypes>Integer String Text Structure</ArgumentTypes>
		<DataType>  Text String</DataType>
		<RelatedFunctions>requestHttp getHttp readHtmlPage</RelatedFunctions>
        <RelatedVMInstructions> none   </RelatedVMInstructions>
		<HumanKeywords> html webpage url http browser request post</HumanKeywords>
	</KnowledgeBase>
         <Description><![CDATA[
             <p> The <b>postHttp</b> function utilizes the internal function <b>requestHttp</b>.</p>
          ]]></Description>
	<Brief>
	   <Overview><![CDATA[
		  <p> The <b>postHttp</b> function utilizes the internal function <b>requestHttp</b>.
            Please refer to the description for <b>requestHttp</b> for more detailed information 
           on the <b>postHttp</b> operation.</p>
        <p>When <b>postHttp</b> is invoked, AIS acts like a browser. It sends requests to an
          internet server on the web, called a host, and receives back a page from the host. 
          Use <b>postHttp</b> to respond to a form where the host expects a POST request from
           the browser. It is up to user of this function to specify the correct names and fields 
           expected by the host. For example, when first contacting a site, a logon form may be 
          returned by the host when a getHttp requests the default page. To be specific,
          suppose that the following page is returned in response to a getHttp request:</p>
        <pre>
     	    <HTML><HEAD><TITLE> Sample Post Form </TITLE></HEAD>
			<BODY><H3>InvestByLambda </H3><P>
			Please enter your username and password and then select submit:</P>
			<FORM NAME="download" METHOD="post" ACTION=
			"http://downloadnow/download.phtml">Name:<P>
			<INPUT TYPE="text" NAME="name" SIZE=32 MAXLENGTH=256>
			<INPUT TYPE="text" NAME="password" SIZE=32 MAXLENGTH=256></P>
			<INPUT TYPE="submit" NAME="Submit"></FORM></BODY></HTML>
        </pre>
        <p>The body of the POST request that is sent back from the server is a URL-encoded 
          query string of the form:</p>
        <p><b>name=jsmith&password=secret</b></p>
        <p>The <b>postHttp</b> request to emulate the request that would be generated by the 
          browser when the submit button is selected might be:</p>
         <p><b>(postHttp "http://downloadnow/download.phtml" "name|jsmith|password|secret")</b></p>
        <p>where | stands for a DEL character whose ascii code is 127.</p>
        <p>Note that the POST body is passed as a DEL-delimited string that is automatically 
           converted into a URL-encoded string by <b>postHttp</b>.</p>
        <p>The second argument, that specifies the body of the post, may also be passed as a
              structure. In this case, the above example might also be:</p>
         <p><b>(postHttp "http://downloadnow/download.phtml" #{name: "jsmith" password: "secret"})</b></p>
       ]]></Overview>
        <Usage><![CDATA[
            <p>Use the <b>postHttp</b> function to automate the collection of information from
           the internet. Use <b>getHttp</b> to fetch pages and use <b>postHttp</b> to submit a 
           POST request after a form is received from the host. It is up to the programmer to
           include the precise set of fields expected by the host in the body argument.</p>
        <p>Unlike <b>readHtmlPage</b>, connections are automatically maintained, and responses 
          can be saved in a file. Further, <b>readHtmlPage</b> cannot submit a POST request.</p>
        ]]></Usage>
    </Brief>
	<Syntax>
	    <Expression><![CDATA[<p><b>  (postHttp url body filename msecToWait)</b></p>
]]></Expression>
		<Argument>
		  <Name>url </Name>
		  <Note><![CDATA[
		  <p>Any complete or partial URL as described above. Required.</p>
          ]]></Note>
		  <AISTypes>Symbol</AISTypes>
		</Argument>
		<Argument> 
		  <Name>body</Name>
		  <Note><![CDATA[
		  <p>A DEL-delimited string or a structure containing name-value pairs that
           is converted to a URL-encoded body of a POST request. .</p>
          ]]></Note>
		  <AISTypes>Structure String</AISTypes>
		</Argument>
		<Argument>
		  <Name>filename</Name>
		  <Note><![CDATA[
		  <p>If provided, the returned web page is saved in the specified file on the client
            machine. The file is saved in a path relative to the current working directory. 
           Optional argument.</p>
          ]]></Note>
		  <AISTypes>Text String</AISTypes>
		</Argument>
		<Argument> 
		  <Name>msecToWait</Name>
		  <Note><![CDATA[
		  <p>If provided, it sets the maximum time to wait for a page to be returned from 
          the host. If no response occurs in the allotted time, an error message is returned. 
          The default value for this parameter is about 2000 msecs.</p>
          ]]></Note>
		  <AISTypes>Integer</AISTypes>
		</Argument>
		<Return><![CDATA[
	    <p>Returns the entire contents of the specified HTML page including all tags.
          If the timeout expires or if an error is detected, an error message is returned.
         </p>
	    ]]></Return>
	</Syntax>
</Function>
